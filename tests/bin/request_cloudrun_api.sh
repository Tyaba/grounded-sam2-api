#!/usr/bin/env bash
set -eu

# サービスのURLを取得
URL=$(gcloud run services describe $SERVICE_NAME \
  --region=us-central1 \
  --project=$GOOGLE_CLOUD_PROJECT \
  --format='value(status.url)')

# IDトークンを取得
TOKEN=$(gcloud auth print-identity-token)

# detectエンドポイントのテスト
detect_response=$(curl -s -o /dev/null -w "%{http_code}" \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"text": "bottle.", "image": "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"}' \
  "$URL/detect")

# segmentエンドポイントのテスト
segment_response=$(curl -s -o /dev/null -w "%{http_code}" \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"text": "bottle.", "image": "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"}' \
  "$URL/segment")

# レスポンスコードを確認
if [ "$detect_response" -eq 200 ] && [ "$segment_response" -eq 200 ]; then
  echo "両方のAPIテストが成功しました"
  echo "detect endpoint: $detect_response"
  echo "segment endpoint: $segment_response"
  exit 0
else
  echo "APIテストが失敗しました"
  echo "detect endpoint: $detect_response"
  echo "segment endpoint: $segment_response"
  exit 1
fi